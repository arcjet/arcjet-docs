---
title: "Introduction to Arcjet Filters"
description: "Use Arcjet filters to block unwanted traffic, VPNs, proxies, and risky countries based on IP reputation and request fields, all configured directly in your code."
prev: false
---

import { Badge } from "@astrojs/starlight/components";
import WhatIsArcjet from "/src/components/WhatIsArcjet.astro";
import Comments from "../../../components/Comments.astro";

Arcjet filters let you define custom security and traffic rules inside your
application code. Use filters to block unwanted traffic based on request
fields, IP reputation, geography, VPN or proxy usage, and other signals.

<WhatIsArcjet />

You write expressions in a [domain-specific
language][arcjet-filters-reference-expression-language] (DSL) that match against
request fields. Filters can use:

- **Literal fields** - values directly from the request, such as the
  `user-agent` header or client IP address.
- **Reflected fields** - derived values based on Arcjet analysis, such as the
  client's country or whether the IP belongs to a known VPN, proxy, or relay
  service.

Other platforms provide similar rule engines at the CDN or network layer. Arcjet
filters are different because you configure and run them inside your application
code. This gives you full, dynamic control over what to allow or block, where,
and when.

Filters are ideal for handling custom logic that is not covered by other Arcjet
rules. For example, you can block a custom bot that is not (yet) recognized by
[Arcjet bot protection][arcjet-bot-protection].

## When to use Arcjet filters

Use filters when you want to block or shape traffic in your application based on
flexible conditions. For example:

- Block a specific bot or user agent string.
- Block traffic from a particular country or region.
- Block known VPNs, proxies, or relay services.
- Apply different rules for high-risk IP ranges or ASNs.
- Combine multiple signals (for example, country + VPN + user agent) into a
  single rule.

You can also access the `ip` field on an Arcjet decision and handle requests
manually in your application code. The key difference is:

- **Filters** integrate blocking with other Arcjet rules.
- **`decision.ip` fields** are better for customizing the response, such as
  showing a specific message or challenge.

See the [VPN & proxy detection blueprint][arcjet-blueprint-vpn-proxy] for a
concrete example.

## How Arcjet filters work

Arcjet evaluates your filter expressions using a high-performance engine
implemented in Rust and compiled to WebAssembly, which runs per request. This is
bundled in the Arcjet SDK so there's nothing extra to install or run in your
application.

### Filter rules and expression language

You define your logic using a [domain-specific
language][arcjet-filters-reference-expression-language] (DSL). This language is
parsed and evaluated by the Rust crate
[`arcjet/wirefilter`][github-arcjet-wirefilter] (a fork of
[`cloudflare/wirefilter`][github-cloudflare-wirefilter]).

The filter engine is shipped locally within the WebAssembly bundled with the
Arcjet SDKs, so expression parsing and evaluation are fast and do not depend on
network round-trips.

### IP-based fields and reputation data

All `ip.src.*` [fields][arcjet-filters-reference-fields] reflect information
about the client IP address. These fields require IP reputation data from the
Arcjet Cloud API, so a call to the Cloud API is required to populate them.

Examples include:

- Whether the IP is a known VPN, proxy, or relay.
- The country and region associated with the IP.
- Other IP intelligence used in your filters.

Other, non-IP fields are analyzed locally by the SDK and do not require a
network call.

### Single Cloud API call and performance

Arcjet makes at most one call to the Cloud API per request, regardless of how
many rules or filters you configure. The Cloud API is designed for high
performance and low latency, and is deployed to multiple regions worldwide. The
SDK automatically uses the closest region, so the total overhead is typically no
more than 20-30 ms, often significantly less.

See the [architecture reference][arcjet-architecture-cloud-api] for more
details.

### Fingerprints and your concept of "user"

Clients are tracked by configurable [fingerprints][arcjet-fingerprints] that
include IP addresses by default. This means clients sharing the same IP address
can be blocked or limited as a group.

To ensure rules are applied correctly, choose fingerprint characteristics
that align with the fields used in your filters and match your concept of a
"user" (for example, IP only vs IP + user ID vs IP + session).

## Availability

- Many filter fields are available on the free plan.
- Additional IP analysis (including much of the `ip.src.*` field set) is
  available on paid plans.

| Field                    | <Badge text="Free" variant="caution" /> | <Badge text="Starter" variant="note" /> | <Badge text="Business" variant="tip" /> |
| ------------------------ | :-------------------------------------: | :-------------------------------------: | :-------------------------------------: |
| `http.host`              |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `http.request.cookie`    |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `http.request.headers`   |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `http.request.method`    |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `http.request.uri.args`  |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `http.request.uri.path`  |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `ip.src.accuracy_radius` |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.asnum.country`   |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.asnum.domain`    |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.asnum.name`      |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.asnum.type`      |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.asnum`           |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.city`            |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.continent.name`  |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.continent`       |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.country.name`    |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `ip.src.country`         |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `ip.src.hosting`         |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `ip.src.lat`             |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.lon`             |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.postal_code`     |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.proxy`           |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `ip.src.region`          |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.relay`           |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `ip.src.service`         |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `ip.src.timezone.name`   |                   ðŸš«                    |                   âœ…                    |                   âœ…                    |
| `ip.src.tor`             |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `ip.src.vpn`             |                   âœ…                    |                   âœ…                    |                   âœ…                    |
| `ip.src`                 |                   âœ…                    |                   âœ…                    |                   âœ…                    |

<Comments />

[arcjet-architecture-cloud-api]: /architecture#arcjet-cloud-api
[arcjet-blueprint-vpn-proxy]: /blueprints/vpn-proxy-detection
[arcjet-bot-protection]: /bot-protection/intro
[arcjet-filters-reference-expression-language]: /filters/reference#expression-language
[arcjet-filters-reference-fields]: /filters/reference#fields
[arcjet-fingerprints]: /fingerprints
[github-arcjet-wirefilter]: https://github.com/arcjet/wirefilter
[github-cloudflare-wirefilter]: https://github.com/cloudflare/wirefilter
